0  ' EGL Image Language Picture Display Program: translation, scaling, reflection, rotation
1 ' By John Galt for MBASIC and FABGL ANSI Terminal: 5/09/2025
2 PRINT CHR$(27)+"_GPEN255;255;255":PRINT CHR$(27)+"_GBRUSH0;0;0"
5 ON ERROR GOTO 30000
10 DEF FNUP$(C$)=CHR$(ASC(C$)-32*(ASC(C$)>96)*(ASC(C$)<123)) ' UPPER CASE CONVERTER
15 WIDTH 80
20 PRINT CHR$(27)+"[2J"+CHR$(27)+"[H"; ' CLEAR SCREEN
30 PRINT:PRINT "		All EGL Images Files Found on Disk:":PRINT:PRINT
40 FILES "*.EGL":PRINT:PRINT
50 GOSUB 20500 ' LOAD FILE ROUTINE
55 PRINT:PRINT
60 INPUT "		ENTER SCALE: ",S
70 INPUT "		ENTER X OFFSET: ",MX
80 INPUT "		ENTER Y OFFSET: ",MY

81 PRINT:PRINT"		+====== Available Transformations =======+"
82 PRINT"		| 0 =   0-Degree Image Normal            |" 
83 PRINT"		| 1 =  90-Degree Image Rotate            |"
84 PRINT"		| 2 = 180-Degree Image Rotate            |"
85 PRINT"		| 3 = 270-Degree Image Rotate            |" 
86 PRINT"		| 4 =   0-Degree Image Normal Reflection |" 
87 PRINT"		| 5 =  90-Degree Image Rotate Reflection |"  
88 PRINT"		| 6 = 180-Degree Image Rotate Reflection |" 
89 PRINT"		| 7 = 270-Degree Image Rotate Reflection |"
90 PRINT"		+========================================+"
91 INPUT " 		ENTER A TRANSFORMATION(0 TO 7)",XYREFLECT
92 IF (XYREFLECT<0 OR XYREFLECT>7) THEN GOTO 91
95 PRINT CHR$(27)+"_E0":PRINT CHR$(27)+"[2J"+CHR$(27)+"[H"; ' CLEAR SCREEN
100 PRINT CHR$(27)+"_GPEN255;255;255"
120 INPUT #1,N$
135 WIDTH 255

140 IF EOF(1) THEN 650 ' MAIN LOOP
150 INPUT #1,SHAPECLASS,SHAPEX1,SHAPEY1,SHAPEX2,SHAPEY2,SHAPER,SHAPEG,SHAPEB
155 IF SHAPECLASS=-1 THEN MX=SHAPEX1:MY=SHAPEY1:S=SHAPEX2:XYREFLECT=SHAPEY2 'Automatic override

156 PRINT CHR$(27)+"_GPEN"+STR$(SHAPER)+";"+STR$(SHAPEG)+";"+STR$(SHAPEB) ' SET PEN COLOR
157 PRINT CHR$(27)+"_GBRUSH"+STR$(SHAPER)+";"+STR$(SHAPEG)+";"+STR$(SHAPEB) ' SET FILL COLOR


158 IF (XYREFLECT=0) THEN GOTO 290 ' 0-Degree Image Normal    (X,Y)
159 IF (XYREFLECT=1) THEN GOTO 350 ' 90-Degree Image Rotate       (Y,-X)
160 IF (XYREFLECT=2) THEN GOTO 330 ' 180-Degree Image Rotate     (-X,-Y)
161 IF (XYREFLECT=3) THEN GOTO 340 ' 270-Degree Image Rotate       (-Y,X)

162 IF (XYREFLECT=4) THEN GOTO 310 ' 0-Degree Image Normal Reflection  (-X,Y)
163 IF (XYREFLECT=5) THEN GOTO 300 ' 90-Degree Image Rotate Reflection (Y,X)
164 IF (XYREFLECT=6) THEN GOTO 320 ' 180-Degree Image Rotate Reflection  (X,-Y)
165 IF (XYREFLECT=7) THEN GOTO 360 ' 270-Degree Image Rotate Reflection (-Y,-X)


290 ' (X,Y) NORMAL 0 DEGREE
291 IF SHAPECLASS=1 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GPIXEL"STR$(INT((SHAPEX1*S)-MX))";"STR$(INT((SHAPEY1*S)-MY))"$"                                                               ' DRAW PIXEL
292 IF SHAPECLASS=2 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GLINE"STR$(INT((SHAPEX1*S)-MX))";"STR$(INT((SHAPEY1*S)-MY))";"STR$(INT((SHAPEX2*S)-MX))";"STR$(INT((SHAPEY2*S)-MY))"$"        ' DRAW LINE
293 IF SHAPECLASS=3 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GRECT"STR$(INT((SHAPEX1*S)-MX))";"STR$(INT((SHAPEY1*S)-MY))";"STR$(INT((SHAPEX2*S)-MX))";"STR$(INT((SHAPEY2*S)-MY))"$"        ' DRAW BOX
294 IF SHAPECLASS=4 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GFILLRECT"STR$(INT((SHAPEX1*S)-MX))";"STR$(INT((SHAPEY1*S)-MY))";"STR$(INT((SHAPEX2*S)-MX))";"STR$(INT((SHAPEY2*S)-MY))"$"    ' DRAW FILL BOX
295 IF SHAPECLASS=5 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GELLIPSE"STR$(INT((SHAPEX1*S)-MX))";"STR$(INT((SHAPEY1*S)-MY))";"STR$(INT(SHAPEX2*S))";"STR$(INT(SHAPEY2*S))"$"               ' DRAW CIRCLE
296 IF SHAPECLASS=6 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GFILLELLIPSE"STR$(INT((SHAPEX1*S)-MX))";"STR$(INT((SHAPEY1*S)-MY))";"STR$(INT(SHAPEX2*S))";"STR$(INT(SHAPEY2*S))"$"           ' DRAW FILL CIRCLE
297 IF SHAPECLASS=7 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GELLIPSE"STR$(INT((SHAPEX1*S)-MX))";"STR$(INT((SHAPEY1*S)-MY))";"STR$(INT(SHAPEX2*S))";"STR$(INT(SHAPEY2*S))"$"               ' DRAW ELLIPSE
298 IF SHAPECLASS=8 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GFILLELLIPSE"STR$(INT((SHAPEX1*S)-MX))";"STR$(INT((SHAPEY1*S)-MY))";"STR$(INT(SHAPEX2*S))";"STR$(INT(SHAPEY2*S))"$"           ' DRAW FILL ELLIPSE
299 GOTO 400

300 ' OVER THE LINE Y=X (Y,X)
301 IF SHAPECLASS=1 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GPIXEL"STR$(INT((SHAPEY1*S)-MX))";"STR$(INT((SHAPEX1*S)-MY))"$"                                                               ' DRAW PIXEL
302 IF SHAPECLASS=2 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GLINE"STR$(INT((SHAPEY1*S)-MX))";"STR$(INT((SHAPEX1*S)-MY))";"STR$(INT((SHAPEY2*S)-MX))";"STR$(INT((SHAPEX2*S)-MY))"$"        ' DRAW LINE
303 IF SHAPECLASS=3 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GRECT"STR$(INT((SHAPEY1*S)-MX))";"STR$(INT((SHAPEX1*S)-MY))";"STR$(INT((SHAPEY2*S)-MX))";"STR$(INT((SHAPEX2*S)-MY))"$"        ' DRAW BOX
304 IF SHAPECLASS=4 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GFILLRECT"STR$(INT((SHAPEY1*S)-MX))";"STR$(INT((SHAPEX1*S)-MY))";"STR$(INT((SHAPEY2*S)-MX))";"STR$(INT((SHAPEX2*S)-MY))"$"    ' DRAW FILL BOX
305 IF SHAPECLASS=5 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GELLIPSE"STR$(INT((SHAPEY1*S)-MX))";"STR$(INT((SHAPEX1*S)-MY))";"STR$(INT(SHAPEY2*S))";"STR$(INT(SHAPEX2*S))"$"               ' DRAW CIRCLE
306 IF SHAPECLASS=6 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GFILLELLIPSE"STR$(INT((SHAPEY1*S)-MX))";"STR$(INT((SHAPEX1*S)-MY))";"STR$(INT(SHAPEY2*S))";"STR$(INT(SHAPEX2*S))"$"           ' DRAW FILL CIRCLE
307 IF SHAPECLASS=7 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GELLIPSE"STR$(INT((SHAPEY1*S)-MX))";"STR$(INT((SHAPEX1*S)-MY))";"STR$(INT(SHAPEY2*S))";"STR$(INT(SHAPEX2*S))"$"               ' DRAW ELLIPSE
308 IF SHAPECLASS=8 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GFILLELLIPSE"STR$(INT((SHAPEY1*S)-MX))";"STR$(INT((SHAPEX1*S)-MY))";"STR$(INT(SHAPEY2*S))";"STR$(INT(SHAPEX2*S))"$"           ' DRAW FILL ELLIPSE
309 GOTO 400

310 ' OVER THE Y-AXIS (-X,Y) 512 to 384
311 IF SHAPECLASS=1 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GPIXEL"STR$(INT(512-(SHAPEX1*S)-MX))";"STR$(INT((SHAPEY1*S)-MY))"$"                                                                     ' DRAW PIXEL
312 IF SHAPECLASS=2 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GLINE"STR$(INT(512-(SHAPEX1*S)-MX))";"STR$(INT((SHAPEY1*S)-MY))";"STR$(INT(512-(SHAPEX2*S)-MX))";"STR$(INT((SHAPEY2*S)-MY))"$"        ' DRAW LINE
313 IF SHAPECLASS=3 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GRECT"STR$(INT(512-(SHAPEX1*S)-MX))";"STR$(INT((SHAPEY1*S)-MY))";"STR$(INT(512-(SHAPEX2*S)-MX))";"STR$(INT((SHAPEY2*S)-MY))"$"        ' DRAW BOX
314 IF SHAPECLASS=4 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GFILLRECT"STR$(INT(512-(SHAPEX1*S)-MX))";"STR$(INT((SHAPEY1*S)-MY))";"STR$ (INT(512-(SHAPEX2*S)-MX))";"STR$(INT((SHAPEY2*S)-MY))"$"    ' DRAW FILL BOX
315 IF SHAPECLASS=5 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GELLIPSE"STR$(INT(512-(SHAPEX1*S)-MX))";"STR$(INT((SHAPEY1*S)-MY))";"STR$(INT(SHAPEX2*S))";"STR$(INT(SHAPEY2*S))"$"                     ' DRAW CIRCLE
316 IF SHAPECLASS=6 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GFILLELLIPSE"STR$(INT(512-(SHAPEX1*S)-MX))";"STR$(INT((SHAPEY1*S)-MY))";"STR$(INT(SHAPEX2*S))";"STR$(INT(SHAPEY2*S))"$"                 ' DRAW FILL CIRCLE
317 IF SHAPECLASS=7 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GELLIPSE"STR$(INT(512-(SHAPEX1*S)-MX))";"STR$(INT((SHAPEY1*S)-MY))";"STR$(INT(SHAPEX2*S))";"STR$(INT(SHAPEY2*S))"$"                     ' DRAW ELLIPSE
318 IF SHAPECLASS=8 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GFILLELLIPSE"STR$(INT(512-(SHAPEX1*S)-MX))";"STR$(INT((SHAPEY1*S)-MY))";"STR$(INT(SHAPEX2*S))";"STR$(INT(SHAPEY2*S))"$"                 ' DRAW FILL ELLIPSE
319 GOTO 400

320 ' OVER THE X-AXIS (X,-Y) change the 512 to 384
321 IF SHAPECLASS=1 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GPIXEL"STR$(INT((SHAPEX1*S)-MX))";"STR$(INT(384-(SHAPEY1*S)-MY))"$"                                                               ' DRAW PIXEL
322 IF SHAPECLASS=2 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GLINE"STR$(INT((SHAPEX1*S)-MX))";"STR$(INT(384-(SHAPEY1*S)-MY))";"STR$(INT((SHAPEX2*S)-MX))";"STR$(INT(384-(SHAPEY2*S)-MY))"$"        ' DRAW LINE
323 IF SHAPECLASS=3 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GRECT"STR$(INT((SHAPEX1*S)-MX))";"STR$(INT(384-(SHAPEY1*S)-MY))";"STR$(INT((SHAPEX2*S)-MX))";"STR$(INT(384-(SHAPEY2*S)-MY))"$"        ' DRAW BOX
324 IF SHAPECLASS=4 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GFILLRECT"STR$(INT((SHAPEX1*S)-MX))";"STR$(INT(384-(SHAPEY1*S)-MY))";"STR$(INT((SHAPEX2*S)-MX))";"STR$(INT(384-(SHAPEY2*S)-MY))"$"    ' DRAW FILL BOX
325 IF SHAPECLASS=5 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GELLIPSE"STR$(INT((SHAPEX1*S)-MX))";"STR$(INT(384-(SHAPEY1*S)-MY))";"STR$(INT(SHAPEX2*S))";"STR$(INT(SHAPEY2*S))"$"               ' DRAW CIRCLE
326 IF SHAPECLASS=6 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GFILLELLIPSE"STR$(INT((SHAPEX1*S)-MX))";"STR$(INT(384-(SHAPEY1*S)-MY))";"STR$(INT(SHAPEX2*S))";"STR$(INT(SHAPEY2*S))"$"           ' DRAW FILL CIRCLE
327 IF SHAPECLASS=7 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GELLIPSE"STR$(INT((SHAPEX1*S)-MX))";"STR$(INT(384-(SHAPEY1*S)-MY))";"STR$(INT(SHAPEX2*S))";"STR$(INT(SHAPEY2*S))"$"               ' DRAW ELLIPSE
328 IF SHAPECLASS=8 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GFILLELLIPSE"STR$(INT((SHAPEX1*S)-MX))";"STR$(INT(384-(SHAPEY1*S)-MY))";"STR$(INT(SHAPEX2*S))";"STR$(INT(SHAPEY2*S))"$"           ' DRAW FILL ELLIPSE
329 GOTO 400

330' THROUGH THE ORIGIN (-X,-Y) 180 DEGREE 512 to 384
331 IF SHAPECLASS=1 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GPIXEL"STR$(INT(512-(SHAPEX1*S)-MX))";"STR$(INT(384-(SHAPEY1*S)-MY))"$"                                                               ' DRAW PIXEL
332 IF SHAPECLASS=2 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GLINE"STR$(INT(512-(SHAPEX1*S)-MX))";"STR$(INT(384-(SHAPEY1*S)-MY))";"STR$(INT(512-(SHAPEX2*S)-MX))";"STR$(INT(384-(SHAPEY2*S)-MY))"$"        ' DRAW LINE
333 IF SHAPECLASS=3 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GRECT"STR$(INT(512-(SHAPEX1*S)-MX))";"STR$(INT(384-(SHAPEY1*S)-MY))";"STR$(INT(512-(SHAPEX2*S)-MX))";"STR$(INT(384-(SHAPEY2*S)-MY))"$"        ' DRAW BOX
334 IF SHAPECLASS=4 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GFILLRECT"STR$(INT(512-(SHAPEX1*S)-MX))";"STR$(INT(384-(SHAPEY1*S)-MY))";"STR$(INT(512-(SHAPEX2*S)-MX))";"STR$(INT(384-(SHAPEY2*S)-MY))"$"    ' DRAW FILL BOX
335 IF SHAPECLASS=5 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GELLIPSE"STR$(INT(512-(SHAPEX1*S)-MX))";"STR$(INT(384-(SHAPEY1*S)-MY))";"STR$(INT(SHAPEX2*S))";"STR$(INT(SHAPEY2*S))"$"               ' DRAW CIRCLE
336 IF SHAPECLASS=6 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GFILLELLIPSE"STR$(INT(512-(SHAPEX1*S)-MX))";"STR$(INT(384-(SHAPEY1*S)-MY))";"STR$(INT(SHAPEX2*S))";"STR$(INT(SHAPEY2*S))"$"           ' DRAW FILL CIRCLE
337 IF SHAPECLASS=7 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GELLIPSE"STR$(INT(512-(SHAPEX1*S)-MX))";"STR$(INT(384-(SHAPEY1*S)-MY))";"STR$(INT(SHAPEX2*S))";"STR$(INT(SHAPEY2*S))"$"               ' DRAW ELLIPSE
338 IF SHAPECLASS=8 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GFILLELLIPSE"STR$(INT(512-(SHAPEX1*S)-MX))";"STR$(INT(384-(SHAPEY1*S)-MY))";"STR$(INT(SHAPEX2*S))";"STR$(INT(SHAPEY2*S))"$"           ' DRAW FILL ELLIPSE
339 GOTO 400

340 ' 90 DEGREE (-Y,X)
341 IF SHAPECLASS=1 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GPIXEL"STR$(INT(512-(SHAPEY1*S)-MX) )";"STR$(INT((SHAPEX1*S)-MY))"$"                                                               ' DRAW PIXEL
342 IF SHAPECLASS=2 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GLINE"STR$(INT(512-(SHAPEY1*S)-MX) )";"STR$(INT((SHAPEX1*S)-MY))";"STR$(INT(512-(SHAPEY2*S)-MX))";"STR$(INT((SHAPEX2*S)-MY))"$"        ' DRAW LINE
343 IF SHAPECLASS=3 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GRECT"STR$(INT(512-(SHAPEY1*S)-MX) )";"STR$(INT((SHAPEX1*S)-MY))";"STR$(INT(512-(SHAPEY2*S)-MX))";"STR$(INT((SHAPEX2*S)-MY))"$"        ' DRAW BOX
344 IF SHAPECLASS=4 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GFILLRECT"STR$(INT(512-(SHAPEY1*S)-MX) )";"STR$(INT((SHAPEX1*S)-MY))";"STR$(INT(512-(SHAPEY2*S)-MX))";"STR$(INT((SHAPEX2*S)-MY))"$"    ' DRAW FILL BOX
345 IF SHAPECLASS=5 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GELLIPSE"STR$(INT(512-(SHAPEY1*S)-MX) )";"STR$(INT((SHAPEX1*S)-MY))";"STR$(INT(SHAPEY2*S))";"STR$(INT(SHAPEX2*S))"$"               ' DRAW CIRCLE
346 IF SHAPECLASS=6 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GFILLELLIPSE"STR$(INT(512-(SHAPEY1*S)-MX) )";"STR$(INT((SHAPEX1*S)-MY))";"STR$(INT(SHAPEY2*S))";"STR$(INT(SHAPEX2*S))"$"           ' DRAW FILL CIRCLE
347 IF SHAPECLASS=7 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GELLIPSE"STR$(INT(512-(SHAPEY1*S)-MX) )";"STR$(INT((SHAPEX1*S)-MY))";"STR$(INT(SHAPEY2*S))";"STR$(INT(SHAPEX2*S))"$"               ' DRAW ELLIPSE
348 IF SHAPECLASS=8 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GFILLELLIPSE"STR$(INT(512-(SHAPEY1*S)-MX) )";"STR$(INT((SHAPEX1*S)-MY))";"STR$(INT(SHAPEY2*S))";"STR$(INT(SHAPEX2*S))"$"           ' DRAW FILL ELLIPSE
349 GOTO 400

350 ' 270 DEGREE (Y,-X) 512 384
351 IF SHAPECLASS=1 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GPIXEL"STR$(INT((SHAPEY1*S)-MX))";"STR$(INT(512-(SHAPEX1*S)-MY))"$"                                                               ' DRAW PIXEL
352 IF SHAPECLASS=2 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GLINE"STR$(INT((SHAPEY1*S)-MX))";"STR$(INT(512-(SHAPEX1*S)-MY))";"STR$(INT((SHAPEY2*S)-MX))";"STR$(INT(512-(SHAPEX2*S)-MY))"$"        ' DRAW LINE
353 IF SHAPECLASS=3 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GRECT"STR$(INT((SHAPEY1*S)-MX))";"STR$(INT(512-(SHAPEX1*S)-MY))";"STR$(INT((SHAPEY2*S)-MX))";"STR$(INT(512-(SHAPEX2*S)-MY))"$"        ' DRAW BOX
354 IF SHAPECLASS=4 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GFILLRECT"STR$(INT((SHAPEY1*S)-MX))";"STR$(INT(512-(SHAPEX1*S)-MY))";"STR$(INT((SHAPEY2*S)-MX))";"STR$(INT(512-(SHAPEX2*S)-MY))"$"    ' DRAW FILL BOX
355 IF SHAPECLASS=5 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GELLIPSE"STR$(INT((SHAPEY1*S)-MX))";"STR$(INT(512-(SHAPEX1*S)-MY))";"STR$(INT(SHAPEY2*S))";"STR$(INT(SHAPEX2*S))"$"               ' DRAW CIRCLE
356 IF SHAPECLASS=6 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GFILLELLIPSE"STR$(INT((SHAPEY1*S)-MX))";"STR$(INT(512-(SHAPEX1*S)-MY))";"STR$(INT(SHAPEY2*S))";"STR$(INT(SHAPEX2*S))"$"           ' DRAW FILL CIRCLE
357 IF SHAPECLASS=7 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GELLIPSE"STR$(INT((SHAPEY1*S)-MX))";"STR$(INT(512-(SHAPEX1*S)-MY))";"STR$(INT(SHAPEY2*S))";"STR$(INT(SHAPEX2*S))"$"               ' DRAW ELLIPSE
358 IF SHAPECLASS=8 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GFILLELLIPSE"STR$(INT((SHAPEY1*S)-MX))";"STR$(INT(512-(SHAPEX1*S)-MY))";"STR$(INT(SHAPEY2*S))";"STR$(INT(SHAPEX2*S))"$"           ' DRAW FILL ELLIPSE
359 GOTO 400

360 ' MIRROR 90 DEGREE (-Y,-X)
361 IF SHAPECLASS=1 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GPIXEL"STR$(INT(512-(SHAPEY1*S)-MX) )";"STR$(INT(512-(SHAPEX1*S)-MY))"$"                                                               ' DRAW PIXEL
362 IF SHAPECLASS=2 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GLINE"STR$(INT(512-(SHAPEY1*S)-MX) )";"STR$(INT(512-(SHAPEX1*S)-MY))";"STR$(INT(512-(SHAPEY2*S)-MX))";"STR$(INT(512-(SHAPEX2*S)-MY))"$"        ' DRAW LINE
363 IF SHAPECLASS=3 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GRECT"STR$(INT(512-(SHAPEY1*S)-MX) )";"STR$(INT(512-(SHAPEX1*S)-MY))";"STR$(INT(512-(SHAPEY2*S)-MX))";"STR$(INT(512-(SHAPEX2*S)-MY))"$"        ' DRAW BOX
364 IF SHAPECLASS=4 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GFILLRECT"STR$(INT(512-(SHAPEY1*S)-MX) )";"STR$(INT(512-(SHAPEX1*S)-MY))";"STR$(INT(512-(SHAPEY2*S)-MX))";"STR$(INT(512-(SHAPEX2*S)-MY))"$"    ' DRAW FILL BOX
365 IF SHAPECLASS=5 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GELLIPSE"STR$(INT(512-(SHAPEY1*S)-MX) )";"STR$(INT(512-(SHAPEX1*S)-MY))";"STR$(INT(SHAPEY2*S))";"STR$(INT(SHAPEX2*S))"$"               ' DRAW CIRCLE
366 IF SHAPECLASS=6 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GFILLELLIPSE"STR$(INT(512-(SHAPEY1*S)-MX) )";"STR$(INT(512-(SHAPEX1*S)-MY))";"STR$(INT(SHAPEY2*S))";"STR$(INT(SHAPEX2*S))"$"           ' DRAW FILL CIRCLE
367 IF SHAPECLASS=7 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GELLIPSE"STR$(INT(512-(SHAPEY1*S)-MX) )";"STR$(INT(512-(SHAPEX1*S)-MY))";"STR$(INT(SHAPEY2*S))";"STR$(INT(SHAPEX2*S))"$"               ' DRAW ELLIPSE
368 IF SHAPECLASS=8 THEN PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_GFILLELLIPSE"STR$(INT(512-(SHAPEY1*S)-MX) )";"STR$(INT(512-(SHAPEX1*S)-MY))";"STR$(INT(SHAPEY2*S))";"STR$(INT(SHAPEX2*S))"$"           ' DRAW FILL ELLIPSE
369 GOTO 400

400 PRINT CHR$(27)+"_GBRUSH0;0;0"
410 COMMAND$=INKEY$: IF COMMAND$="Q" OR COMMAND$="q"  THEN GOTO 650 ' Override drawing
600 GOTO 140 ' END LOOP

650 CLOSE #1
660 PRINT CHR$(27)+"_GPEN255;255;255":PRINT CHR$(27)+"_GBRUSH0;0;0"
670 PRINT CHR$(27)+"[H";:PRINT CHR$(27)+"_F27;46$"+"PRESS 'ESC' KEY TO RETURN TO CP/M";
680 WHILE INKEY$<>CHR$(27):WEND
690 PRINT CHR$(27)+"[2J"+CHR$(27)+"[H";
700 PRINT CHR$(27)+"_E1"
710 END ' END PROGRAM

20500 ' FILE NAME CHECK SUBROUTINE
20501 FCHECK=1
20510 LINE INPUT "ENTER FILE NAME TO LOAD (or QUIT): EGL EXTENSION IS AUTOMATIC ->";IMAGEFILE$
20520 IF (IMAGEFILE$="QUIT" OR IMAGEFILE$="quit" OR IMAGEFILE$="Quit" OR IMAGEFILE$="Q" OR IMAGEFILE$="q") THEN END
20521 FOR UPPERC=1 TO LEN(IMAGEFILE$)
20522 MID$(IMAGEFILE$,UPPERC,1)=FNUP$(MID$(IMAGEFILE$,UPPERC,1))
20523 NEXT UPPERC
20525 IF (LEN(IMAGEFILE$)>12) THEN GOTO 20600
20530 CHECKFILE$=RIGHT$(IMAGEFILE$,4)
20540 IF CHECKFILE$=".EGL" THEN GOTO 20560 
20550 IMAGEFILE$=LEFT$(IMAGEFILE$,8)+".EGL" ' APPEND .EGL IF NEEDED
20560 IF (LEN(IMAGEFILE$)<=12) THEN OPEN "I",1,IMAGEFILE$
20590 RETURN

20600 PRINT"ERROR THE FILE NAME IS TOO LONG TRY AGAIN"
20610 PRINT"PRESS 'ESC' KEY TO TRY AGAIN"
20620 WHILE INKEY$<>CHR$(27):WEND
20630 FCHECK=0:GOTO 20500
20640 RETURN

30000 ' ON ERROR GO HERE USUALLY THE FILE NAME WILL NOT EXIST
30005 IF (FCHECK=0) THEN PRINT:PRINT"NO EGL FILES ARE AVAILABLE ON DISK.": GOTO 30070
30010 IF (FCHECK=1) THEN PRINT:PRINT"THE FILE NAME IS NOT VALID OR MISSPELLED."
30020 PRINT"PRESS 'ESC' KEY TO TRY AGAIN"
30030 WHILE INKEY$<>CHR$(27):WEND
30040 CLOSE #1
30050 FCHECK=0
30060 RESUME 10 ' RELOAD THE SCREEN AGAIN
30070 PRINT"PRESS 'ESC' EXITING TO CP/M"
30080 WHILE INKEY$<>CHR$(27):WEND
30090 RESUME 320

